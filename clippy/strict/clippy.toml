# clippy.toml - ASIL-B profile, compatible with your Clippy version
# License: Apache-2.0 (see LICENSE.md).

msrv = "1.84.0"

# ---- Tests / debug behaviour ----
# These flags control whether certain restriction lints are relaxed in tests.
# For ASIL-B we keep them strict even in tests.

allow-unwrap-in-tests = false
allow-expect-in-tests = false
allow-panic-in-tests = false
allow-dbg-in-tests = false
allow-print-in-tests = false
allow-indexing-slicing-in-tests = false
allow-useless-vec-in-tests = false

# ---- Imports / docs ----

warn-on-all-wildcard-imports = true
allowed-wildcard-imports = []

check-private-items = true
missing-docs-in-crate-items = false

# ---- Complexity thresholds ----

cognitive-complexity-threshold = 10
too-many-lines-threshold = 80
too-many-arguments-threshold = 5
type-complexity-threshold = 150
single-char-binding-names-threshold = 2
max-fn-params-bools = 2
max-struct-bools = 2

# ---- Memory / stack usage thresholds ----

stack-size-threshold = 65536  # bytes
array-size-threshold = 4096   # bytes
large-error-threshold = 64    # bytes
pass-by-value-size-limit = 128  # bytes
too-large-for-stack = 128     # bytes

# ---- Disallowed macros (IO, unfinished code) ----

disallowed-macros = [
  # No direct printing in safety-related code
 # { path = "std::print",    reason = "no stdout in ASIL-B component" },
 # { path = "std::println",  reason = "no stdout in ASIL-B component" },
 # { path = "std::eprint",   reason = "no stderr in ASIL-B component" },
 # { path = "std::eprintln", reason = "no stderr in ASIL-B component" },

  # No unfinished code
  { path = "std::todo",          reason = "no unfinished functionality in ASIL-B component" },
  { path = "std::unimplemented", reason = "no unfinished functionality in ASIL-B component" },
]

# ---- Disallowed methods (belt & suspenders for unwrap/expect) ----

disallowed-methods = [
  # Result
  #{ path = "core::result::Result::unwrap", reason = "use '?', map_err, or explicit error handling instead" },
  #{ path = "core::result::Result::expect", reason = "use '?', map_err, or explicit error handling instead" },

  # Option
 # { path = "core::option::Option::unwrap", reason = "handle None explicitly" },
 #{ path = "core::option::Option::expect", reason = "handle None explicitly" },
]

# ---- Optional: disallow some types globally ----

disallowed-types = [
  { path = "std::net::TcpStream", reason = "no direct network IO in this ASIL-B component" },
]
